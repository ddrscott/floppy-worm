# Floppy Worm

A physics-based worm game built with Phaser.js and Matter.js, featuring realistic worm locomotion and fun physics interactions.

## Quick Start

```bash
# Install dependencies
npm install

# Build and serve locally
npm run dev
```

Then open http://localhost:8080/demo-index.html

## Project Structure

```
floppy-worm/
├── src/                    # Source files
│   ├── Worm.js            # Reusable Worm class (ES6 module)
│   ├── test-worm-class.js # Demo using Worm class
│   ├── test-worm-v2.js    # Full-featured demo with GUI
│   └── worm-examples.js   # Additional examples
├── dist/                  # Bundled output (generated by esbuild)
├── demo-index.html        # Demo launcher page
├── test-worm-class.html   # Worm class demo
├── phaser.html           # Full-featured demo
└── package.json          # Build configuration
```

## Development

This project uses **esbuild** for fast JavaScript bundling. All source files are ES6 modules that get bundled for browser use.

### Available Scripts

```bash
# Build all demos
npm run build:all

# Build individual demos
npm run build        # Builds test-worm-class
npm run build:v2     # Builds test-worm-v2

# Development servers (with live reload)
npm run dev          # Full-featured dev server with live reload
npm run dev:simple   # Simple esbuild server (manual refresh)
npm run dev:live     # Using live-server (install deps first)

# Watch mode (auto-rebuild on file changes)
npm run watch        # Watches test-worm-class
npm run watch:v2     # Watches test-worm-v2
npm run watch:all    # Watches all files

# Serve locally (static, no rebuild)
npm run serve        # Starts server on port 8080
```

### Live Reload Options

1. **`npm run dev`** (Recommended)
   - Custom dev server with automatic page refresh
   - Watches both JS and HTML files
   - No additional dependencies needed

2. **`npm run dev:simple`**
   - Uses esbuild's built-in server
   - Auto-rebuilds but requires manual refresh
   - Simplest setup

3. **`npm run dev:live`**
   - Uses live-server package
   - Requires `npm install` to get additional dependencies
   - Most feature-rich (includes CSS injection)

## Using the Worm Class

The `Worm` class is designed to be easily integrated into any Phaser/Matter.js project:

```javascript
import { Worm } from './Worm.js';

// In your Phaser scene
create() {
    // Create a worm at position (x, y)
    this.worm = new Worm(this, 100, 300, {
        baseRadius: 10,
        segmentSizes: [0.75, 1, 1, 0.95, 0.9, 0.8, 0.8],
        motorSpeed: 5,
        jumpStiffness: 0.05
    });
}

update(delta) {
    // Control the worm
    this.worm.setMotorDirection(-1); // left
    this.worm.setMotorDirection(1);  // right
    this.worm.setMotorDirection(0);  // stop
    
    this.worm.setFlatten(true/false);
    this.worm.setJump(true/false);
    
    // Update physics
    this.worm.update(delta);
}
```

## Controls

- **Arrow Keys**: Move left/right
- **Down Arrow**: Flatten (contract segments)
- **Spacebar**: Jump (spring launch)
- **Mouse**: Drag worm segments
- **Scroll**: Zoom in/out

## Features

- Realistic worm physics with segmented body
- Motor-driven locomotion
- Flatten mechanic for compression
- Jump mechanic for launching
- Fully configurable physics parameters
- Modular, reusable Worm class
- dat.GUI integration for real-time parameter tweaking

## Technical Details

- **Physics Engine**: Matter.js (via Phaser)
- **Game Framework**: Phaser 3
- **Build Tool**: esbuild
- **Module System**: ES6 modules

The worm uses a chain of circular bodies connected by constraints. Movement is achieved through a motor mechanism attached to the second segment, while special behaviors like flattening and jumping are implemented using dynamic spring constraints.

## License

MIT